{% extends "gold_loan/base.html" %}
{% load static %}

{% block title %}Gold Loan | Punnagai{% endblock %}

{% block head %}
<link rel="stylesheet" href="{% static 'gold_loan/css/home.css' %}?v=3.0">
{% endblock %}

{% block page_header %}{% endblock %}

{% block content %}
<div class="landing-wrapper">
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-overlay"></div>

        <div class="container hero-content-grid">
            <!-- Left Side: Text & Actions -->
            <div class="hero-text">
                <span class="hero-badge">Trusted & Secure</span>
                <h1 class="animate-fadeInUp">PUNNAGAI <br>Gold Loan</h1>
                <p class="animate-fadeInUp delay-1">
                    Experience the standard of trust, transparency, and accuracy.
                    Manage gold loans with precision, from valuation to closure.
                </p>

                <div class="hero-actions animate-fadeInUp delay-2">
                    <a href="{% url 'gold_loan:loan_entry_step1' %}" class="btn btn-primary btn-lg btn-glow">
                        Create New Loan
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left:8px">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </a>
                    <a href="{% url 'gold_loan:dashboard' %}" class="btn btn-secondary btn-lg">
                        View Dashboard
                    </a>
                </div>

                <div class="hero-stats animate-fadeInUp delay-3">
                    <div class="stat-item">
                        <span class="stat-val">100%</span>
                        <span class="stat-label">Secure</span>
                    </div>
                    <div class="stat-divider"></div>
                    <div class="stat-item">
                        <span class="stat-val">0%</span>
                        <span class="stat-label">Hidden Charges</span>
                    </div>
                    <div class="stat-divider"></div>
                    <div class="stat-item">
                        <span class="stat-val">24/7</span>
                        <span class="stat-label">Data Access</span>
                    </div>
                </div>
            </div>

            <!-- Right Side: Visual Calculator Card -->
            <div class="hero-visual animate-slideInRight">
                <div class="glass-card trust-dashboard">
                    <div class="gc-header">
                        <div class="gc-status">
                            <span class="status-pulse"></span>
                            Live Approvals
                        </div>
                        <div class="gc-icon">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
                            </svg>
                        </div>
                    </div>

                    <div class="gc-body dashboard-content">
                        <div class="metric-row">
                            <div class="metric-info">
                                <h3>Approval Speed</h3>
                                <p>Average processing time today</p>
                            </div>
                            <div class="metric-value">6.5 <small>min</small></div>
                        </div>

                        <div class="progress-section">
                            <div class="progress-label">
                                <span>Verification Progress</span>
                                <span>94%</span>
                            </div>
                            <div class="progress-bar-wrap">
                                <div class="progress-fill" style="width: 94%"></div>
                            </div>
                        </div>

                        <div class="feature-grid-small">
                            <div class="f-pill">
                                <span class="f-icon">ðŸ›¡</span>
                                <span>Bank Grade</span>
                            </div>
                            <div class="f-pill">
                                <span class="f-icon">âš¡</span>
                                <span>Instant</span>
                            </div>
                        </div>

                        <div class="activity-mini">
                            <div class="activity-item">
                                <div class="avatar-sm" style="background: #eff6ff;">S</div>
                                <div class="activity-text">
                                    <strong>â‚¹ 2.5L Loan</strong> Approved for Suresh M.
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="gc-decoration">
                        <svg viewBox="0 0 400 100" preserveAspectRatio="none">
                            <path d="M0,80 C150,20 250,120 400,40 V100 H0 Z" fill="rgba(37, 99, 235, 0.05)"></path>
                            <path d="M0,80 C150,20 250,120 400,40" fill="none" stroke="rgba(37, 99, 235, 0.2)"
                                stroke-width="2"></path>
                        </svg>
                    </div>
                </div>

                <!-- Floating Elements for depth -->
                <div class="float-card fc-1 animate-float">
                    <div class="fc-icon success">âœ“</div>
                    <div class="fc-text">
                        <span>Instant Gold Loan Eligibility</span>
                        <small>Punnagai Certified</small>
                    </div>
                </div>

                <div class="float-card fc-2 animate-float">
                    <div class="fc-icon success" style="background: #eff6ff; color: var(--primary);">âœ“</div>
                    <div class="fc-text">
                        <span>Trusted by 50,000+</span>
                        <small>Active Customers</small>
                    </div>
                </div>

                <div class="float-card fc-3 animate-float">
                    <div class="fc-icon success" style="background: #fff7ed; color: #f59e0b;">ðŸ›¡</div>
                    <div class="fc-text">
                        <span>Safe Bank Vaults</span>
                        <small>100% Insured</small>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 2: ABOUT / TRUST -->
    <section class="section about-section" id="about">
        <div class="container about-single">
            <div class="about-content animate-on-scroll">
                <div class="center-text">
                    <span class="section-badge">Why Choose Us</span>
                    <h2>Why Choose <span class="highlight">Punnagai Gold Loan?</span></h2>
                    <p class="section-desc">
                        We ensure your gold is valued transparently and securely. Experience the fastest approval
                        process
                        with zero hidden charges.
                    </p>
                </div>
                <ul class="feature-list grid-features">
                    <li>
                        <div class="icon-box">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                        </div>
                        <div class="text">
                            <strong>Transparent Valuation</strong>
                            <span>Live market rates applied instantly.</span>
                        </div>
                    </li>
                    <li>
                        <div class="icon-box">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                            </svg>
                        </div>
                        <div class="text">
                            <strong>Secure Gold Handling</strong>
                            <span>Bank-grade security vaults for safety.</span>
                        </div>
                    </li>
                    <li>
                        <div class="icon-box">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                        </div>
                        <div class="text">
                            <strong>Fast Approvals</strong>
                            <span>Get cash in hand within minutes.</span>
                        </div>
                    </li>
                    <li>
                        <div class="icon-box">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                        </div>
                        <div class="text">
                            <strong>Accurate Interest Tracking</strong>
                            <span>Pay only for the days you use.</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <!-- SECTION 3: GOLD LOAN CALCULATOR -->
    <section class="section calculator-section" id="calculator">
        <div class="container">
            <div class="section-header center animate-on-scroll">
                <span class="section-badge">Plan Ahead</span>
                <h2>Gold Loan Calculator</h2>
                <p>Estimate your loan amount based on current gold rates.</p>
            </div>

            <div class="calculator-card animate-on-scroll delay-1">
                <div class="calc-inputs">
                    <!-- Gold Weight -->
                    <div class="input-group">
                        <div class="label-row">
                            <label>Gold Weight (grams)</label>
                            <input type="number" id="weightInput" value="50" min="1" max="500">
                        </div>
                        <input type="range" id="weightSlider" min="1" max="500" value="50" class="range-slider">
                    </div>

                    <!-- Interest Rate -->
                    <div class="input-group">
                        <div class="label-row">
                            <label>Interest Rate (% per annum)</label>
                            <input type="number" id="rateInput" value="12" min="1" max="36" step="0.5">
                        </div>
                        <input type="range" id="rateSlider" min="1" max="36" step="0.5" value="12" class="range-slider">
                    </div>

                    <!-- Tenure -->
                    <div class="input-group">
                        <div class="label-row">
                            <label>Tenure (Months)</label>
                            <input type="number" id="tenureInput" value="6" min="1" max="24">
                        </div>
                        <input type="range" id="tenureSlider" min="1" max="24" value="6" class="range-slider">
                    </div>
                </div>

                <div class="calc-result">
                    <div class="result-box">
                        <span class="label">Estimated Loan Amount</span>
                        <div class="amount-wrap">
                            <span class="currency">â‚¹</span>
                            <span class="value" id="loanAmount">2,00,000</span>
                        </div>
                        <p class="disclaimer">* Indicative value based on market rate. Final value may vary.</p>
                        <a href="{% url 'gold_loan:loan_entry_step1' %}" class="btn btn-primary btn-block btn-lg"
                            style="text-decoration: none;">
                            Apply for this Loan
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 4: TRUST METRICS / STATS -->
    <section class="section stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card animate-on-scroll">
                    <div class="stat-number" data-target="100">0</div>
                    <div class="stat-label">Secure</div>
                    <div class="stat-sub">% Safety Guarantee</div>
                </div>
                <div class="stat-card animate-on-scroll delay-1">
                    <div class="stat-number" data-target="0">0</div>
                    <div class="stat-label">Hidden Charges</div>
                    <div class="stat-sub">Transparent Process</div>
                </div>
                <div class="stat-card animate-on-scroll delay-2">
                    <div class="stat-number" data-target="24">0</div>
                    <div class="stat-label">Data Access</div>
                    <div class="stat-sub">/7 Availability</div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION 5: FOOTER (Bajaj Style) -->
    <footer class="app-footer">
        <div class="container">
            <div class="footer-top">
                <div class="footer-col">
                    <h4 class="accordion-header">About Punnagai <span class="chevron">â€º</span></h4>
                    <ul class="footer-links">
                        <li><a href="#">Our Story</a></li>
                        <li><a href="#">Leadership</a></li>
                        <li><a href="#">Careers</a></li>
                        <li><a href="#">Contact Us</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="accordion-header">Products <span class="chevron">â€º</span></h4>
                    <ul class="footer-links">
                        <li><a href="#">Gold Loan</a></li>
                        <li><a href="#">SME Loan</a></li>
                        <li><a href="#">Investments</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="accordion-header">Calculators <span class="chevron">â€º</span></h4>
                    <ul class="footer-links">
                        <li><a href="#">Gold Loan Calculator</a></li>
                        <li><a href="#">EMI Calculator</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4 class="accordion-header">Legal <span class="chevron">â€º</span></h4>
                    <ul class="footer-links">
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Use</a></li>
                        <li><a href="#">Fair Practice Code</a></li>
                    </ul>
                </div>
                <div class="footer-col contact-col">
                    <h4>Reach Us</h4>
                    <p>1800-123-4567</p>
                    <p>support@punnagai.com</p>
                    <div class="social-icons">
                        <!-- Icons using basic shapes or SVGs if needed, keeping simple text for now or simple circles -->
                        <div class="soc-icon">fb</div>
                        <div class="soc-icon">in</div>
                        <div class="soc-icon">yt</div>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Punnagai Gold Loan. All Rights Reserved.</p>
                <p class="small-text">CIN: U65990TN2025PTC000000</p>
            </div>
        </div>
    </footer>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- Header Scroll Effect ---
        const header = document.querySelector('.app-header');
        window.addEventListener('scroll', function () {
            if (header) {
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            }
        });

        // --- Scroll Animations (Intersection Observer) ---
        const observerOptions = {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px"
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');

                    // Trigger counter animation if it's a stat card
                    if (entry.target.classList.contains('stat-card')) {
                        const numEl = entry.target.querySelector('.stat-number');
                        if (numEl && !numEl.classList.contains('counted')) {
                            animateValue(numEl, 0, parseInt(numEl.dataset.target), 2000);
                            numEl.classList.add('counted');
                        }
                    }
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.animate-on-scroll').forEach(el => {
            observer.observe(el);
        });
        document.querySelectorAll('.stat-card').forEach(el => {
            observer.observe(el);
        });


        // --- Calculator Logic ---
        const weightSlider = document.getElementById('weightSlider');
        const weightInput = document.getElementById('weightInput');
        const rateSlider = document.getElementById('rateSlider');
        const rateInput = document.getElementById('rateInput');
        const tenureSlider = document.getElementById('tenureSlider');
        const tenureInput = document.getElementById('tenureInput');
        const loanAmountDisplay = document.getElementById('loanAmount');

        function syncInputs(slider, input) {
            slider.addEventListener('input', () => {
                input.value = slider.value;
                calculateLoan();
            });
            input.addEventListener('input', () => {
                slider.value = input.value;
                calculateLoan();
            });
            input.addEventListener('change', () => calculateLoan());
        }

        syncInputs(weightSlider, weightInput);
        syncInputs(rateSlider, rateInput);
        syncInputs(tenureSlider, tenureInput);

        function calculateLoan() {
            const weight = parseFloat(weightInput.value) || 0;
            // Simple Logic: Rate around 4000 per gram (just an example)
            // Ideally this comes from backend, but "Frontend Only" requested.
            const ratePerGram = 4000;
            const total = weight * ratePerGram;

            // Format currency
            loanAmountDisplay.innerText = total.toLocaleString('en-IN');

            // Animate scale slightly
            loanAmountDisplay.style.transform = "scale(1.1)";
            setTimeout(() => {
                loanAmountDisplay.style.transform = "scale(1)";
            }, 200);
        }

        // Initial calc
        calculateLoan();

        // --- Counter Animation ---
        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                // Handle 0% and 100% and 24/7 specific formatting if needed
                let val = Math.floor(progress * (end - start) + start);

                // Specific fix for "0% Hidden Charges" -> we want to show 0
                // Specific fix for "100%" -> we want to show 100

                let suffix = "";
                if (obj.nextElementSibling && obj.nextElementSibling.innerText.includes("%")) {
                    // suffix handled in HTML structure? No, suffix is separate div
                }

                // If end is 0, we just want 0.

                obj.innerHTML = val;

                // Hacky fix for formatting:
                if (end === 100) obj.innerHTML = val + "%";
                if (end === 0) obj.innerHTML = val + "%";
                if (end === 24) obj.innerHTML = val + "/7";

                if (progress < 1) {
                    window.requestAnimationFrame(step);
                } else {
                    // Final Ensure
                    if (end === 100) obj.innerHTML = "100%";
                    if (end === 0) obj.innerHTML = "0%";
                    if (end === 24) obj.innerHTML = "24/7";
                }
            };
            window.requestAnimationFrame(step);
        }

        // --- Footer Accordion (Mobile) ---
        const accordions = document.querySelectorAll('.accordion-header');
        accordions.forEach(acc => {
            acc.addEventListener('click', function () {
                if (window.innerWidth <= 768) {
                    this.parentElement.classList.toggle('active');
                    const links = this.nextElementSibling;
                    if (this.parentElement.classList.contains('active')) {
                        links.style.display = "block";
                    } else {
                        links.style.display = "none";
                    }
                }
            });
        });

        // Reset footer links on resize
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                document.querySelectorAll('.footer-links').forEach(el => el.style.display = 'block');
            } else {
                document.querySelectorAll('.footer-col').forEach(col => {
                    col.classList.remove('active');
                    if (col.querySelector('.footer-links')) col.querySelector('.footer-links').style.display = 'none';
                });
            }
        });
        // Initial check
        if (window.innerWidth <= 768) {
            document.querySelectorAll('.footer-links').forEach(el => el.style.display = 'none');
        }

    });
</script>
{% endblock %}