{% extends "gold_loan/receipts/invoice_base.html" %}

{% block title %}Payment Receipt - {{ payment.id }}{% endblock %}
{% block invoice_type %}Payment Receipt{% endblock %}
{% block invoice_no %}PAY-{{ payment.id }}{% endblock %}

{% block content %}
<div class="customer-section" style="margin-bottom: 10mm;">
    <div class="customer-details" style="width: 100%; margin-left: 0;">
        <div class="section-title">Customer Details</div>
        <div style="display: table; width: 100%;">
            <div style="display: table-cell; width: 50%;">
                <div class="field-row">
                    <span class="field-label">Name:</span>
                    <span class="field-value">{{ customer.name }}</span>
                </div>
                <div class="field-row">
                    <span class="field-label">Customer ID:</span>
                    <span class="field-value">{{ customer.customer_id }}</span>
                </div>
            </div>
            <div style="display: table-cell; width: 50%;">
                <div class="field-row">
                    <span class="field-label">Loan No:</span>
                    <span class="field-value">{{ loan.loan_number }}</span>
                </div>
                <div class="field-row">
                    <span class="field-label">Mobile:</span>
                    <span class="field-value">{{ customer.mobile_primary }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="section-title" style="color: #be185d; border-color: #fbcfe8;">Transaction Summary</div>
<div style="background: #fdf2f8; border-radius: 8px; padding: 5mm; margin-bottom: 10mm; border: 1px solid #fbcfe8;">
    <div style="text-align: center;">
        <div style="font-size: 10pt; color: #be185d; text-transform: uppercase; font-weight: bold; margin-bottom: 2mm;">
            Amount Received</div>
        <div style="font-size: 28pt; font-weight: bold; color: #be185d;">₹{{ payment.total_amount }}</div>
        <div style="font-size: 10pt; color: #64748b; margin-top: 2mm;">via {{ payment.get_payment_mode_display }}</div>
    </div>
</div>

<div class="section-title">Payment Breakdown</div>
<table style="margin-bottom: 5mm;">
    <thead>
        <tr>
            <th>Description</th>
            <th style="text-align: right;">Amount</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Interest Component</td>
            <td style="text-align: right; font-weight: bold;">₹{{ payment.interest_component }}</td>
        </tr>
        <tr>
            <td>Principal Component</td>
            <td style="text-align: right; font-weight: bold;">₹{{ payment.principal_component }}</td>
        </tr>
    </tbody>
</table>

<div class="total-section">
    <div class="total-row">
        <span>Payment Date:</span>
        <span>{{ payment.payment_date|date:"d M Y" }}</span>
    </div>
    {% if payment.reference_no %}
    <div class="total-row">
        <span>Reference No:</span>
        <span>{{ payment.reference_no }}</span>
    </div>
    {% endif %}
    <div class="total-row final" style="color: #be185d; border-color: #be185d;">
        <span>Total Received:</span>
        <span>₹{{ payment.total_amount }}</span>
    </div>
</div>

<div class="section-title" style="margin-top: 10mm;">Loan Status After Payment</div>
<div style="display: table; width: 100%; font-size: 10pt;">
    <div style="display: table-cell; width: 50%;">
        <div class="field-row">
            <span class="field-label">Outstanding Principal:</span>
            <span class="field-value">₹{{ outstanding_principal|floatformat:2 }}</span>
        </div>
    </div>
    <div style="display: table-cell; width: 50%;">
        <div class="field-row">
            <span class="field-label">Current Loan Status:</span>
            <span class="badge badge-success">{{ loan.get_status_display }}</span>
        </div>
    </div>
</div>

{% if payment.remarks %}
<div style="margin-top: 5mm; font-size: 10pt; font-style: italic; color: #64748b;">
    <strong>Remarks:</strong> {{ payment.remarks }}
</div>
{% endif %}
{% endblock %}